+++
title = '這裡是哪裡？'
slug = 'new blog by Hugo'
date =  2023-09-03T11:41:07+08:00
draft = false
categories = ['WEB']
tags = ['HUGO','GITHUB','NETLIFY']
+++

回到醫院工作也有兩三年了，陸陸續續也寫了不少為了解決重複工作的各種小程式，但是因為主管個性比較 **~~機車~~** 積極，許多只是為了解決自己分內工作上的便利小程式，雖然也許推廣出去之後可能會得到更廣大的效果，後來還是決定低調自用就好。

## 開始找地方寫文章記錄
雖然是低調自用，不過還是想來分享一下這幾年我到底寫了什麼，踩了多少坑，用什麼方法修復的，決定還是找個地方好好地記錄下來。
想寫文章大概是 2020 年左右的事，不過一拖就已經來到 2023年了，當時找的平台 Medium 如今看來只剩下方便編寫的功能，甚至文章不是使用 Markdown 語法，可能造成搬遷困難。

稍微 Google 了之後毅然決然使用當今正紅的 Static Side Generation 來架構 Blog ，雖然跟我熟悉的後端語法背道而馳，但是如果因為這樣可以學到一些比較新穎的前端技術也算有所成長。

## Hugo 和 Zola 要選誰
前端語言苦手的我，不管是選了誰都踩了不小的坑。在經過一兩天的摸索之後，我得到了以下不客觀的結論：
#### Hugo
1. 使用者族群眾多，themes 也很多
2. 產生的架構看起來龐大好像也比較亂
3. 模板語言好像以 GO 撰寫，我比較沒有經驗
#### Zola
1. 產生的結構乾淨，看起來比較直覺
2. 使用者族群超少，themes 又少又醜 (?)
3. 模板語言是 tera ，看起來跟 django 類似，我比較有經驗

但是因為是初學的關係，後來是選擇使用 Hugo ，至少踩坑了比較多使用經驗可以查詢，或許以後可以自學 GO Lang 也說不定 ~~(哪來年輕人的時間)~~。

## Hello Hugo!
決定好 SSG 之後就照著[官方文件](https://gohugo.io/)的指引一步一步來，但一開始就卡關了......

以我的開發作業系統 Windows ，先安裝了 [Scoop](https://scoop.sh/) ，接著在 Windows 的 cmd 視窗中輸入：
```powershell
scoop install hugo-extended
```

因為接下來會在桌面上建立一個資料夾，方便我每天的更新和撰寫，在桌面上按下 `shift` + 滑鼠右鍵，選擇`在這裡開啟 PowerShell 視窗`，利用以下指令建立資料夾
```powershell
hugo new site blog
```

用這個指令生成的資料夾中會包含一個 config 檔案 `hugo.toml`，是 toml 格式的設定檔。這個格式無論是在 Hugo 中或是在 Zola 中都一樣。

接下來的步驟是下載好看的佈景主題 themes ，除了找到自己覺得好看的，當然也可以參考該佈景主題在 Github 中的星星數，畢竟都選了熱門的 SSG ，當然也要選熱門的 themes。

選了 [Hugo-Papermod](https://github.com/adityatelange/hugo-PaperMod) ，於是按照官方指引在剛剛建立的 blog 資料夾底下先初始化 git ，再利用 submodule 把 themes 下載下來。

```powershell
git init
git submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
```

## 好想一次把版面設定到好：hugo.toml
但是不可能，這時候的 `hugo.toml` 空空如也，下載回來的 themes 也還需要客製化之後才能繼續使用。

而且因為 themes 的作者喜歡的設定檔格式是 yml (yaml)，在作者寫的 installation 指引中有提到一個 `config.yml` 的設定，其實就是現在這個版本的 `hugo.toml` ，差別就是必須把 yaml 格式改成 toml ，也因為現在大部分網站，包含後續的 Netlify 也是使用 toml 格式作為設定檔，乾脆就統一使用 toml 格式。

依照我現在的需求，目前不需要開任何分享、不需要訪客回應，甚至也不需要多國語言設定 (這樣我要把打過的文章拿去餵 ChatGPT 嗎)，不需要個人介紹頁面。

不過其實也算平易近人，按照 themes 作者的安裝指引，網頁最底下有個 [Sample config.yml](https://github.com/adityatelange/hugo-PaperMod/wiki/Installation#sample-configyml) 利用 yaml 轉 toml 的轉檔程式，或是選擇自己要的部分自己轉成 toml 也可以，以下是這個網站的設定檔：
```toml
baseURL = "https://lambo.tw/"
languageCode = "zh-Hants-TW"
title = "lambo"
theme = "PaperMod"
paginate = 15
enableInlineShortcodes = true
enableRobotsTXT = true
hasCJKLanguage = true
isCJKLanguage = true
enableEmoji = true
pygmentsUseClasses = true

[minify]
disableXML = true

[outputs]
home = [ "HTML", "RSS", "JSON" ]

[permalinks]
posts = "/:year/:month/:slug/"

[params]
env = "production"
description = "紀錄使用python和php等多種程式處理醫院藥庫的管理情境。"
keyword = [
  "python",
  "php",
  "hospital",
  "pharmacy",
  "stock",
  "inventory",
  "pharmacist"
]
author = "lambo"
defaultTheme = "auto"
dateFormat = "2006 / 1 / 2"
ShowReadingTime = true
ShowWordCount = true
ShowPostNavLinks = true
ShowBreadCrumbs = true
ShowCodeCopyButtons = true

[params.homeInfoParams]
Title = "lambo"
Content = """
記錄一些利用 python, PHP 等寫出的小工具處理醫院藥庫的日常工作情形。
"""

[[params.socialIcons]]
name = "facebook"
url = "https://www.facebook.com/lambo.lyu/"

[[params.socialIcons]]
name = "instagram"
url = "https://www.instagram.com/lambolyu/"

[params.assets]
disableHLJS = true

[markup.goldmark.renderer]
unsafe = true

[markup.highlight]
noClasses = false

[[menu.main]]
identifier = "archives"
name = "文章列表"
url = "/archives/"
weight = 10

[[menu.main]]
identifier = "tags"
name = "標籤"
url = "/tags/"
weight = 30

[[menu.main]]
identifier = "categories"
name = "類別"
url = "/categories/"
weight = 40

[[menu.main]]
identifier = "home"
name = "首頁"
url = "/"
weight = 0
```

## 自己增加額外的 archives 和 search
依照剛剛設定好的 menu ，裡面增加了 archives 的頁面是原本 Hugo 沒有的，因此需要利用指令的功能：
```powershell
hugo new content archives.md
```
新增一個 md 檔的頁面到 content 資料夾底下，並且修改文件內容。
```markdown
+++
title = "文章列表"
layout = "archives"
url = "/archives/"
summary = "archives"
+++
```

同理也可以依照 theme 作者的指引新增 search 的頁面，但目前我還用不到這個，所以先不新增。

## 自己中文化 tags 和 categories
因為 Hugo 沒有 archives 和 search ，但是 theme 可以渲染，所以需要額外新增頁面補強功能，這帶來了一個好處是可以藉由修改 archives.md 等檔案來中文化，或是標題符合我們想要的樣子。但是內建的 tags 和 categories 要中文化，就要修改 layouts 中的模板了。

模板目前存在的位置在 themes 中，如果直接改 themes 中的模板，將來 themes 更新時會被覆蓋掉，因此如果我們需要修改模板，必須複製一份到相對應的根目錄， Hugo 會以根目錄的模板網頁為優先渲染對象。

舉例來說，現在要修改的檔案位在

`\themes\PaperMod\layouts\_default\term.html`

那麼就得在根目錄裡面新增資料夾並複製一份檔案過去

`\layouts\` → `\layouts\_default\term.html`

接著我們要修改這份 html 檔案中的

```html
<h1>{{ .Title }}</h1>
```

改成這樣，裡面的 `{{}}` 應該就是 GO 語言了吧？

```html
{{ if eq .Title "Tags" }}
    <h1>標籤</h1>
{{- end }}
{{ if eq .Title "Categories" }}
    <h1>分類</h1>
{{- end }}
<!--<h1>{{ .Title }}</h1>-->
```

另外雖然網頁最底下的版權說明很重要，但其實並不好看，所以我也複製了一份 `\layouts\partials\footer.html` 進行了修改。

## 開始用 Markdown 來寫文章吧！
新增文章的方法是在網站的根目錄底下執行
```powershell
hugo new content posts\文章標題.md
```
這個指令會在 `\content\posts\` 新增一份 Makdown 文件，代表一篇文章。

但是 Makdown 文件的前幾行會預設有一個被 `+++` 圍起來的段落，預設長這樣：
```markdown
+++
title = '文章標題'
date = 2023-09-01T11:41:07+08:00
draft = true
+++
```
這個段落被稱為 Front Matter ，是用來讓 SSG 解析文章時的一些設定檔，該檔案在被 `hugo new content` 的時候，會以 `\archetypes\default.md` 為模板生成一份。

所以我也把模板檔改成了以下設定，其中有一項 slug 則是對應之前的 hugo.toml 的 permalinks 區塊，設定的意義是我的這篇文章將在網址上面顯示 `/年/月/Front Matter設定的slug文字` ，聽說這樣的設定有助於 SEO 排名啦。
```markdown
+++
title = '{{ replace .File.ContentBaseName "-" " " | title }}'
slug = '{{ replace .File.ContentBaseName "-" " " | title }}'
date = {{ .Date }}
draft = true
categories = []
tags = []
+++
```

接著就進入寫文章的環節啦，我個人是用 VScode 和一個擴充功能 Markdown Preview Enhanced 來進行撰寫，如果以後開始寫得比較快比較熟，也許會換工具吧？

## 預覽測試
其實邊寫，可以用以下的指令在本地端建立一個網頁伺服器來測試一下網站
```powershell
hugo server -D
```
`-D` 可以讓文章 Front Matter 是 `draft = true` 也就是草稿狀態的文章一同被渲染成靜態網頁。

指令的結果最後幾行大概會如下
```powerhell
(前略)
...
Web Server is available at http://localhost:1313/ (bind address 127.0.0.1)
Press Ctrl+C to stop
```
這個網頁伺服器建立的網頁其實滿神奇的，只要根目錄裡面的檔案有所更動，不必關閉再重新執行，十分方便。甚至也可開著網頁伺服器來邊寫 Markdown 文章，邊預覽文章效果。


## 部署網頁

完成第一篇文章後，終於可以把網站上線了，不過這個步驟其實沒有文章可以進行。

網站的上線其實有兩種方式：

1. 註冊 Github 後，新增一個 repository 成為 Github Pages ，此時的 repository 名稱必須是 `github名稱.github.io` 。接著在網頁的根目錄執行指令 `hugo` ，就會在根目錄底下產生一個 `\public\` 的資料夾，然後把這個資料夾裡面的所有網頁直接 push 上 Github Pages 就完成了。

但其實我比較喜歡第二種方法，不用每次部署都要本地端跑一下 `hugo` ，然後還要根目錄一個 git ， `\public\` 裡面一個 git ，傻傻分不清楚。

2. 註冊 Github 後，新增一個 repository ，直接把根目錄上的所有內容 push 上去。接著利用 Netlity 新增一個 site 串聯 Github 的 repository 。如此一來只要每次的 git push ，就會觸發 Netlity 直接更新網站。





netlify.toml
github 與 gitnub pages 的差異